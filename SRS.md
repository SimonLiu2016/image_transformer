# Software Requirements Specification（SRS）

# 任意图片转换工具 macOS 桌面软件需求和功能说明书

## 1. 产品概述

**产品名称**：Image Transformer

**平台**：macOS 桌面应用（使用 Flutter 框架开发，支持 macOS 11.0 及以上版本）。

**目标用户**：个人用户（如摄影爱好者）、专业设计师、内容创作者，以及需要批量图像处理的中小企业用户。

**产品定位**：一款轻量级、跨平台（但本次聚焦 macOS）的图像转换工具，强调界面美观、操作简易、用户体验优秀。核心功能基于图像处理库（如 image、flutter_image_compress 和 opencv_flutter），实现高效转换而不牺牲质量。

**版本**：1.1（新增预设功能）

**开发框架**：Flutter（确保跨平台兼容，但优化 macOS 原生风格，如支持 Dark Mode、窗口拖拽和系统集成）。

## 2. 需求背景

基于前期调研，该工具需支持任意格式转换、尺寸调整、分辨率修改、其他图像参数修改（如亮度、对比度、旋转、裁剪、压缩），以及批量处理。用户反馈指出，最常见需求是重复应用固定修改策略（如批量转 PNG 和 ICO、固定大小、去除背景、修改分辨率）。为提升效率，新增"预设管理"功能：用户可保存当前参数配置为预设，下次直接加载应用，避免每次手动调整。

## 3. 功能需求

### 3.1 核心功能

- **图像导入**：支持拖拽导入单张或多张图像；从文件浏览器选取；支持常见格式（JPG, PNG, GIF, TIFF, BMP, WebP, HEIC 等）。
- **格式转换**：任意格式互转，支持有损/无损选项。新增：支持同时输出多种格式（如 PNG 和 ICO）。
- **尺寸调整**：指定宽度/高度，等比例缩放；选择插值算法（最近邻、双线性、双立方）。
- **分辨率修改**：调整 DPI 值，支持重采样选项。
- **参数修改**： 
  - **颜色**：亮度、对比度、饱和度、色调调整（滑块控制）。
  - **几何**：旋转（0-360°）、翻转、镜像、裁剪（自由/固定比例）。
  - **滤镜**：模糊、锐化、去噪（基本级别）。新增：背景移除（使用简单算法或集成如 remove.bg API，若可行）。
  - **压缩**：调整质量水平（0-100%），优化文件大小。
- **批量处理**：选取文件夹或多文件；统一应用设置；进度显示和中断支持。新增：直接应用预设到批量任务。
- **导出**：保存单张或批量文件；自定义输出路径、文件名规则（e.g., 原名_converted）；支持覆盖或新建文件夹。

### 3.2 辅助功能（新增预设管理）

- **预设管理**： 
  - **保存预设**：将当前参数配置（如格式、尺寸、分辨率、背景移除等）保存为自定义名称的预设。
  - **加载预设**：从列表选择预设，一键应用到当前图像或批量任务。
  - **编辑/删除预设**：支持修改现有预设；默认提供几个内置预设（如"社交媒体优化"、"打印准备"）。
  - **存储方式**：本地 JSON 文件存储，确保跨会话持久化。
- **预览**：实时预览修改效果（前后对比），支持预设应用后的预览。
- **历史记录**：最近操作列表，支持撤销/重做（限 5-10 步）。
- **设置**：主题切换（Light/Dark 跟随系统）、默认参数、语言（英文/简中）。新增：预设导出/导入（分享预设文件）。
- **帮助**：内置教程、快捷键列表，包括预设使用指南。

### 3.3 用户流程

1. 启动应用：欢迎界面或直接主窗口，加载最近预设。
2. 导入图像：拖拽或按钮选取。
3. 配置参数：侧边面板调整，或直接加载预设。
4. 保存预设：点击"Save Preset"按钮，输入名称保存。
5. 预览并应用：实时查看，确认后处理。
6. 批量模式：切换视图，选择预设应用到多文件。
7. 导出：选择路径保存。

## 4. 非功能需求

- **性能**：单张处理 < 2s；批量（100 张） < 1min（视图像大小）；预设加载即时。
- **易用性**：直观界面，最小点击操作；工具提示（Tooltip）；键盘快捷键（e.g., Cmd+P 保存预设）。
- **美观性**：采用 macOS 原生风格（圆角窗口、半透明侧边栏）；高分辨率图标；响应式布局（窗口大小自适应）。
- **用户体验**：流畅动画（e.g., 参数滑块过渡）；错误反馈（e.g., 格式不支持提示）；预设列表拖拽排序；无广告，隐私保护（本地处理）。
- **安全性**：本地文件处理，无云端上传；权限请求（文件访问）。
- **可访问性**：支持 VoiceOver；高对比模式。
- **测试**：单元测试（功能）、UI 测试（兼容不同 macOS 版本），特别测试预设持久化。

## 5. 技术实现

- **前端**：Flutter Widgets（Material/Cupertino 混合，偏向 Cupertino 以匹配 macOS）。新增：使用 hive 存储预设。
- **后端**：集成 image、flutter_image_compress、multi_image_picker 等包；Isolate 实现批量并行。预设作为 Map<String, dynamic> 序列化。
- **集成**：macOS 特定优化，如 bitsdojo_window 支持自定义标题栏；背景移除若需高级，可集成 OpenCV。
- **部署**：App Store 或 DMG 安装包。

## 6. 风险与假设

- **风险**：预设存储兼容性（不同版本迁移）；背景移除算法质量（需测试多种图像）。
- **假设**：用户熟悉基本 macOS 操作；硬件配置中等（M1+ 芯片）。

# Image Transformer macOS 桌面软件 UI/UX 设计

以下设计聚焦于 macOS 风格：简洁、现代、空间感强。新增预设管理功能，集成到侧边栏和批量视图，确保操作无缝。布局采用侧边栏 + 主预览区 + 底部工具栏，确保操作流畅。颜色方案：Light/Dark 模式，蓝灰主调。字体：San Francisco 系统字体。所有元素支持 Hover 反馈和动画过渡，提升互动性。

## 1. 主界面布局

- **整体结构**：全屏或窗口模式。顶部菜单栏（File, Edit, View, Help）；左侧侧边栏（参数面板 + 预设列表）；中央预览区（图像显示，前后对比）；右侧工具面板（可选，批量切换）；底部状态栏（进度、文件信息）。
- **易用性**：拖拽导入图像直接到预览区；参数调整实时更新预览；新增预设下拉菜单，一键应用。
- **用户操作**：单张模式下，调整参数后点击"Save Preset"保存；加载时从侧边栏顶部下拉选择预设。

> （类似 iMazing Profile Editor 的布局：左侧预设管理面板，提供保存和加载选项。我们的设计会简化，仅聚焦图像参数预设。）

## 2. 参数调整面板（侧边栏）

- **布局**：顶部新增"Presets"部分：下拉菜单列出预设；按钮"Save Current as Preset"（弹出对话框输入名称）；"Manage Presets"（打开编辑视图）。下方折叠式 Accordion（格式、尺寸、分辨率、颜色、几何、滤镜、压缩、背景移除）。
- **美观**：半透明背景，图标辅助（e.g., 书签图标 for 预设）；分组线条分隔。
- **体验**：加载预设后自动填充参数；实时预览；工具提示解释预设（e.g., "应用此预设将设置 PNG 输出、512x512 尺寸"）。

> （如上图，macOS 侧边栏预设设计：我们的面板类似此，动态列表，便于用户快速切换固定策略。）

## 3. 批量处理界面

- **切换**：顶部按钮或菜单切换到批量视图。
- **布局**：左侧文件列表（树状视图，支持文件夹拖拽）；中央预览网格（多张缩略图）；右侧统一参数面板（集成预设选择）。
- **操作**：全选/多选文件；从预设下拉菜单选择策略，一键应用统一设置；进度条显示处理状态（e.g., "处理中 50/100，使用'社交优化'预设"）；暂停/取消按钮。
- **易用**：拖拽排序文件；批量预览随机样本（应用预设后）；导出时选项卡选择路径。

> （如上图，Flutter 桌面批量 UI 与预设集成：我们的设计借鉴此，右侧面板突出预设选项，提升重复任务效率。）

## 4. 预览与导出区

- **预览**：Split View（左原图，右处理后）；缩放/平移支持；全屏模式（F11 快捷键）。应用预设后即时更新。
- **导出**：底部按钮 "Export"；弹出对话框（路径、格式、命名规则）；成功后通知（macOS Notification Center 集成），并记录为历史。
- **美观**：圆角图像边框；淡入动画加载图像。

> （如上图，macOS 原生预览区：我们的设计类似，结合预设反馈，确保用户看到固定策略的应用效果。）

## 5. 整体用户体验优化

- **导航**：面包屑路径（当前文件/文件夹/预设）；搜索栏快速过滤预设列表。
- **快捷键**：Cmd+O 打开，Cmd+S 保存，Cmd+Z 撤销，Cmd+Shift+P 加载预设。
- **响应式**：窗口最小化时折叠侧边栏；触控板手势支持（缩放图像）。
- **测试反馈**：用户测试焦点于预设操作步骤少、视觉舒适；迭代基于 A/B 测试，强调固定策略的便利性。